<!DOCTYPE html>
<html lang="fr">

  <head>
    <link rel="icon" href="img/logo_square.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="main.css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"> </script>
    <script type="text/javascript" src="app.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-F5QY5F8S5L"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-F5QY5F8S5L');
    </script>

    <script>
      $(function(){
        $("#header").load("includes/header.html");
        $("#footer").load("includes/footer.html");
      });
    </script>

    <title>Up Close | Cinéma à Paris</title>

  </head>

  <body class="light-theme">

    <div id="header"></div>

    <h2>Que voir à Paris cette semaine&nbsp;?</h2>

    <script>
      var date_newsletter = "";
      
      $(function() {
        $.getJSON('data/reviews.json', function(data) {
          $.ajaxSetup({cache:false});
          var string = ""
          $.each(data.review, function(i, f) {
            if (i == 0)  {
              date_newsletter = f.date;
              Date_Newsletter = string_to_date(date_newsletter)
              console.log(date_newsletter);
              if (Date_Newsletter.getDay()<3){
                // When we do the newsletter on a monday or a tuesday, it means we are early => get_next_week
                document.getElementById("current_week").innerHTML = week_string(get_next_week(string_to_date(date_newsletter))[0]);
              }
              else {
                // When we do the newsletter on a wednesday or thursday, it means we are late => get_current_week
                document.getElementById("current_week").innerHTML = week_string(get_current_week(string_to_date(date_newsletter))[0]);
              }
            }
          });
          $.each(data.review, function(i, f) {
            if (f.date == date_newsletter){
              string = string.concat(
                "<div class='moviebox'>" +
                  "<img src='img/reviews/" + f.id  + ".png'/>" +
                  "<h3 style='color:grey;'>" + f.category + "</h3>" +
                  "<h3><i>" + f.movie_name + "</i>, " + f.movie_directors + " (" + f.movie_year + ")</h3>" +
                  f.review +
                  "<center><b>" + f.showtime + "</b></center>" +
                "</div><br>"
              )
            }
          });
          document.getElementById("cdc").innerHTML = string
        });
      });

      $(function() {
        $.getJSON('data/weeks.json', function(data) {
          $.ajaxSetup({cache:false});
          var string = ""
          $.each(data.week, function(i, f) {
            if(f.date == date_newsletter){
              string = string.concat(
                "<div class='moviebox'>" +
                  "<h3 style='color:grey;'>" + f.name + "</h3><br>" +
                  f.week +
                "</div><br>"
              )
            }
          });
          document.getElementById("week").innerHTML = string
        });
      });
    </script>

    <h3><span id="current_week"></span></h3>
    <br>
    <span id="cdc"></span>
    <span id="week"></span>

    <div id="footer"></div>

  </body>

</html>
