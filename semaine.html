<!DOCTYPE html>
<html lang="fr">

  <head>

    <link rel="icon" href="img/logo_square.png">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="main.css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"> </script>
    <script type="text/javascript" src="app.js"></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-F5QY5F8S5L"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-F5QY5F8S5L');
    </script>

    <script>
    $(function(){
      $("#header").load("includes/header.html");
      $("#footer").load("includes/footer.html");
    });
    </script>

    <title>La semaine prochaine</title>

  </head>

  <script>
    var d = new Date();
    d.setDate(d.getDate() - 3);

    $(function(){
      document.getElementById("next_week").innerHTML = week_string(get_next_week(d)[0]);
    });

    $(function() {
      start_date = get_next_week(d)[0];
      end_date = get_next_week(d)[1];
      start_monthName = months_short[start_date.getMonth()];
      end_monthName = months_short[end_date.getMonth()];

      $.getJSON('data/classic_movies.json', function(data) {
        $.ajaxSetup({cache:false});
        var prev_movie = "";
        var string = "";
        $.each(data.movies, function(i, f) {
          var movie = f.date;
          var md = new Date(movie[0], movie[1]-1, movie[2], 0, 0, 0, 0)

          max_hour = display_real_dict(f.showtimes_theater)[0];
          new_dict = display_real_dict(f.showtimes_theater)[1];
          real_showtime = display_showtimes(new_dict, sep="; ");

          if (md>=start_date & md<=end_date){
            if (f.title != prev_movie){
              string = string.concat(
                "<br><h3 style='text-align:left'><i>" + f.title + "</i>, " + f.directors + " (" + f.year + ")</h3>"
              )
            }
            string = string.concat(
              "<b>" + days_short[md.getDay()] + " " + md.getDate() + " " + months_short[md.getMonth()] + "</b> " +
              real_showtime + "<br>"
            )
            prev_movie = f.title;
          }
        });
        document.getElementById("week_films").innerHTML = string
      });
    });

  </script>

  <body class="light-theme">

    <div id="header"></div>

    <h2><span id="next_week"></span></h2>
    <span id="week_films"></span>

    <div id="footer"></div>

  </body>
</html>
